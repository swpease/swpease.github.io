<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Scott's Stuff - Science</title><link href="https://swpease.github.io/" rel="alternate"></link><link href="https://swpease.github.io/feeds/science.atom.xml" rel="self"></link><id>https://swpease.github.io/</id><updated>2025-05-29T00:00:00-07:00</updated><entry><title>PA Well Water, Part 1</title><link href="https://swpease.github.io/pa-well-water-part-1.html" rel="alternate"></link><published>2025-05-29T00:00:00-07:00</published><updated>2025-05-29T00:00:00-07:00</updated><author><name>Scott Pease</name></author><id>tag:swpease.github.io,2025-05-29:/pa-well-water-part-1.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;I found a paper on PLOS Water:&lt;/p&gt;
&lt;p&gt;Wamsley M, Coker ES, Wilson RT, Henry K, Murphy HM (2024) Social 
vulnerability and exposure to private well water. PLOS Water 3(12): e0000303.
&lt;a href="https://doi.org/10.1371/journal.pwat.0000303"&gt;https://doi.org/10.1371/journal.pwat.0000303&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I can't do a better job than the authors of …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;I found a paper on PLOS Water:&lt;/p&gt;
&lt;p&gt;Wamsley M, Coker ES, Wilson RT, Henry K, Murphy HM (2024) Social 
vulnerability and exposure to private well water. PLOS Water 3(12): e0000303.
&lt;a href="https://doi.org/10.1371/journal.pwat.0000303"&gt;https://doi.org/10.1371/journal.pwat.0000303&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I can't do a better job than the authors of summarizing the purpose, so 
here's the first few sentences of the abstract:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;One quarter of the population of Pennsylvania relies on private domestic well water: two-fold greater than the US average. Private well owners are responsible for the maintenance and treatment of their water supply. Targeted interventions are needed to support these well owners to ensure they have access to safe drinking water, free of contaminants. To develop appropriate interventions, an understanding of the characteristics and social vulnerability of communities with high well water use is needed. The purpose of this study was to determine the spatial patterning of social vulnerability in Pennsylvania and assess the association between social vulnerability and private domestic wells using profile regression.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I think the paper is interesting, but I found a few issues with it that I 
wanted to go over. This has largely served as a great learning resource for 
me in a number of respects: mapping, Bayesian stats, epidemiology, stats in 
general, demographics... I'll go over the different issues I had over 
several posts. But first, what is "social vulnerability"?&lt;/p&gt;
&lt;h1&gt;Social Vulnerability / Social Vulnerability Index (SVI)&lt;/h1&gt;
&lt;p&gt;"Social vulnerability" has a few definitions that try to get at the same 
meaning, to varying success. I think that the Vermont public health 
department does the best job of explaining social vulnerability and the SVI: 
&lt;a href="https://www.healthvermont.
gov/sites/default/files/documents/2016/12/ENV_EPHT_SocialVulnerabilityIndex.
pdf"&gt;ref&lt;/a&gt;. The &lt;a href="https://www.atsdr.cdc.gov/place-health/php/svi/index.
html"&gt;ATSDR site&lt;/a&gt; has a definition that made me go, "What?", but its definition within 
its detailed &lt;a href="https://www.atsdr.cdc.
gov/place-health/php/svi/svi-data-documentation-download.html"&gt;documentation&lt;/a&gt; is much 
more sensible in my view. Vermont's 
definition is: &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Social vulnerability refers to the resilience of communities when
responding to or recovering from threats to public health.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The ATSDR documentation's is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Every community must prepare for and respond to hazardous events, whether a natural disaster like a tornado or a disease outbreak, or an anthropogenic event such as a harmful chemical spill. The degree to which a community exhibits certain social conditions, including high poverty, low percentage of vehicle access, or crowded households, among others, may affect that community’s ability to prevent human suffering and financial loss in the event of a disaster. These factors describe a community’s social vulnerability.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Similarly, Social Vulnerability Index (SVI) per Vermont is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;a planning tool to evaluate the relative social vulnerability across the 
state. It can be used if there is a disease outbreak or in the event of an 
emergency—either natural or human-caused—to identify populations that may 
need more help.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And for ATSDR is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;to help public health officials and emergency response planners identify 
and map the communities that will most likely need support before, during, 
and after a hazardous event.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In general, I thought the Vermont reference was the best, both for being 
concise, and importantly for highlighting the SVI's limitations. I'd read 
that if I were you.&lt;/p&gt;
&lt;h2&gt;A Brief Aside&lt;/h2&gt;
&lt;p&gt;Going to the ATSDR website shows a banner:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 1" src="https://swpease.github.io/images/science/well_water/ATSDR_site.png"&gt;&lt;/p&gt;
&lt;p&gt;I don't really go on government sites much, so I was astounded.&lt;/p&gt;
&lt;h1&gt;My Issues With This Paper&lt;/h1&gt;
&lt;h2&gt;Re Its Premise&lt;/h2&gt;
&lt;p&gt;I'm actually fine with its premise. A few relevant excerpts:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Since upkeep of private water supplies falls completely on the well-owner, community-level and individual-level social deprivation/vulnerability is likely to be an important determinant of whether well-owners can keep up with the requirements to ensure safe drinking water.&lt;/p&gt;
&lt;p&gt;the socioeconomic and demographic characteristics of the population using domestic wells (that are excluded from public water supplies) are not well described.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;However, I do wonder if in a real situation you might not just ask the 
regional/local government for information on the local well users, giving 
better information than this study could? The aforementioned Vermont user's 
guide seems to agree, referring to the SVI as a "first step" in screening 
populations and adding:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Local information might be more accurate than these
estimates and should always be considered if it is available.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you want to know more, just read the paper's intro.&lt;/p&gt;
&lt;h2&gt;Re Its Conclusions&lt;/h2&gt;
&lt;p&gt;Their analysis indicated that well users were across the gamut of SVI, 
yielding a fairly broad conclusion. Some groups had high SVI (well, I'll argue 
that point later), some low. They say that the high SVI groups comprised a 
large population (1.1 million, ~1/3 of PA well users), but do not provide a 
list of populations for each group, which would have been nice.&lt;/p&gt;
&lt;p&gt;A few instances of trying to work around this nebulousness:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;it seems reasonable to focus education interventions on all high private well use areas&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Well I could've told you that.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The knowledge gained from our analysis in PA informs us that interventions and education campaigns need to be targeted towards homeowners (and some renters), and populations that are more socially vulnerable (have a low level of education, with an annual income less than $30k, are elderly or have children) as well as those that are less socially vulnerable (those with higher levels of education, an annual income over $30k, and are not a sensitive age).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Again, that's a pretty wide net.&lt;/p&gt;
&lt;h2&gt;Re Its Methods&lt;/h2&gt;
&lt;p&gt;This is where problems arose, I think. I want to be clear that I am not 
trying to be mean, that I might be wrong in some respects in my criticisms, 
and that I've been there as a grad student.&lt;/p&gt;
&lt;p&gt;My first doubts arose when looking at the regression formula in the section 
"Multilevel risk model". It is a mess. The indexing is wrong and there is a 
dummy variable trap. I think there might be other issues, but it could just 
be unfamiliar notation.&lt;/p&gt;
&lt;p&gt;I have three primary issues:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;They z-scored by county.&lt;/li&gt;
&lt;li&gt;They didn't include a good "rurality" covariate. &lt;/li&gt;
&lt;li&gt;They didn't actually do Bayesian Profile Regression.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I'll go over each of these in separate posts. I think it's good to have a 
grasp on the "units" in this study: census tracts.&lt;/p&gt;
&lt;h1&gt;Census Tracts&lt;/h1&gt;
&lt;p&gt;This paper references a data source as the US Census Bureau's TIGER/Line 
Shapefiles &lt;a href="https://www.census.
gov/geographies/mapping-files/time-series/geo/tiger-line-file.html"&gt;here&lt;/a&gt;. If you 
download a Shapefile, the dataset's abstract reads in part (emphasis mine):&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Census tracts are small, relatively permanent statistical subdivisions of 
a county or equivalent entity, and were defined by local participants as 
part of the Census 2000 Participant Statistical Areas Program (PSAP). The 
Census Bureau delineated the census tracts in situations where no local 
participant existed or where all the potential participants declined to participate. The primary purpose of census tracts is to provide a stable set of geographic units for the presentation of census data and comparison back to previous decennial censuses. Census tracts generally have a population size between 1,500 and 8,000 people, with an optimum size of 4,000 people. &lt;strong&gt;When first delineated, census tracts were designed to be homogeneous with respect to population characteristics, economic status, and living conditions&lt;/strong&gt;. The spatial size of census tracts varies widely depending on the density of settlement. Physical changes in street patterns caused by highway construction, new development, etc. may require boundary revisions before a census. In addition, census tracts occasionally are split due to population growth, or combined as a result of substantial population decline. Census tract boundaries generally follow visible and identifiable features. They may follow legal boundaries such as minor civil division (MCD) or incorporated place boundaries in some States and situations to allow for census tract-to-governmental unit relationships where the governmental boundaries tend to remain unchanged between censuses. State and county boundaries are always census tract boundaries in the standard census geographic hierarchy. In a few rare instances, a census tract may consist of noncontiguous areas. These noncontiguous areas may occur where the census tracts are coextensive with all or parts of legal entities that are themselves noncontiguous. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Also, looking at the &lt;a href="https://www.census.
gov/programs-surveys/geography/technical-documentation/complete-technical
-documentation/tiger-geo-line.html"&gt;technical documentation&lt;/a&gt; I feel is helpful. For instance, the 
&lt;a href="https://www2.census.gov/geo/pdfs/maps-data/data/tiger/tgrshp2010/TGRSHP10SF1.pdf"&gt;2010 documentation&lt;/a&gt; 
provides a visual hierarchy of census entities in its Figure 1.&lt;/p&gt;
&lt;h1&gt;Simple Issues&lt;/h1&gt;
&lt;h2&gt;Classification&lt;/h2&gt;
&lt;h3&gt;Cluster 14&lt;/h3&gt;
&lt;p&gt;Cluster 14 was classified by the author as having "suggested social 
vulnerability". However, per Fig 5, for the 10 social vulnerability 
covariates, the median quartiles for Cluster 14 were comprised of 5 in 
quartile 2 and 5 in quartile 3, which should indicate a remarkably 
middle-of-the-road social vulnerability level. You might be thinking, "well, 
you have to see the full distributions to know for sure." Well, that's what 
I thought, too. The odd thing is, full distributions are a built-in 
visualization function provided by the R package that I'm guessing they used 
for their analysis.&lt;/p&gt;
&lt;h2&gt;Nitpicks&lt;/h2&gt;
&lt;p&gt;Beyond the aforementioned formula confusion, I found some other errors.&lt;/p&gt;
&lt;h3&gt;Table 1&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Columns are mis-aligned.&lt;/li&gt;
&lt;li&gt;Cluster 1's Poisson model estimate should be 0.28, not 1.28.&lt;/li&gt;
&lt;li&gt;Cluster 12's mean # households should be 1140 or 1149 I'm guessing. They 
   probably fat-fingered 90.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Fig 6&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;The y-axis is cut-off.&lt;/li&gt;
&lt;li&gt;"The random effects due to county are shown in Fig 6." No, they aren't.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Future Writing&lt;/h1&gt;
&lt;p&gt;I'll write separate posts at least on each of my 3 beefs(?) with this paper, 
and want to write some more about Bayesian Profile Regression afterwards.&lt;/p&gt;</content><category term="Science"></category><category term="analysis"></category></entry><entry><title>Sand Crabs Eating Bits of Plastic String (Part 2)</title><link href="https://swpease.github.io/sand-crabs-eating-bits-of-plastic-string-part-2.html" rel="alternate"></link><published>2024-12-17T00:00:00-08:00</published><updated>2024-12-17T00:00:00-08:00</updated><author><name>Scott Pease</name></author><id>tag:swpease.github.io,2024-12-17:/sand-crabs-eating-bits-of-plastic-string-part-2.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;In the &lt;a href="https://swpease.github.io/sand-crabs-eating-bits-of-plastic-string.html"&gt;previous post&lt;/a&gt; on sand crabs, I 
looked at the mortality of the treatments (exposed to environmentally 
relevant concentrations of microplastic 
fibers)
vs controls. Now, I want to look at another outcome that they looked at: egg 
development.&lt;/p&gt;
&lt;p&gt;Specifically, looking at starting vs ending egg development stages. This …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;In the &lt;a href="https://swpease.github.io/sand-crabs-eating-bits-of-plastic-string.html"&gt;previous post&lt;/a&gt; on sand crabs, I 
looked at the mortality of the treatments (exposed to environmentally 
relevant concentrations of microplastic 
fibers)
vs controls. Now, I want to look at another outcome that they looked at: egg 
development.&lt;/p&gt;
&lt;p&gt;Specifically, looking at starting vs ending egg development stages. This 
endpoint is.. much trickier to think about. For starters,
it would 
help 
if I knew much about sand crab reproduction, or developmental biology in 
general; it was always a bit of a snooze for me. I mean, I thought the 
reproductive physiology course I took was interesting, but that's different. &lt;/p&gt;
&lt;p&gt;The authors explain:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The selected experimental time frame (71 d) allowed for two full embryonic 
development cycles as E. analoga has an incubation cycle of 29–32 days.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I don't really get how this works. Why is one full cycle insufficient? Are 
they expecting slower development in the treatment crabs? Is this just my 
lack of 
understanding of developmental biology?&lt;/p&gt;
&lt;p&gt;Adding onto that, there is another observed variable, "# of days with viable 
eggs", which I don't really understand with respect to the start/end egg 
development stages. Do the eggs become inviable after completed development? 
Are there commonly miscarriages (or the egg equivalent)? I guess I should 
just treat this as an exercise in Bayesian stats. It's not like I'll have 
any idea on how to make a useful prior, anyway. &lt;/p&gt;
&lt;h1&gt;Data Discrepancies (Again)&lt;/h1&gt;
&lt;p&gt;I am using the GitHub data, because the Zenodo data for egg development 
doesn't make sense. The GitHub data also has several issues, but at least 
mostly makes sense. For the GitHub data, there are 3 control crabs missing 
and 4 treatment crabs 
missing, 
which yields 29 control crabs and 28 treatment crabs.&lt;/p&gt;
&lt;p&gt;I made a couple of bar charts as descriptive statistics-type things, which 
let me notice that Treatment Crab #5 has wrong data for its egg development 
columns. I was going to just omit it, but I see that there are two other crabs 
for 
which the "# of egg stages(start to finish)" column — which should presumably 
validate the difference between start and end egg stages — is off by one, so 
I think that Treatment Crab #5's end stage was "Z", not 2, plus its "# of egg 
stages(start to finish)" is off by two. This supports by "bad handwriting" 
hypothesis from the previous post. I know I started putting lines through my 
Z's after doing math where some formula creator (I'm guessing with good 
handwriting) 
decided to use Z's and 2's all over the place. Stupid mxn. Stupid ijk. At 
least I'm &lt;a href="https://betterexplained.
com/articles/linear-algebra-guide/"&gt;not alone&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also, there is a column "Reach Larval Stage(9+) Y/N", which has six 
discrepancies with "Egg Stage end of exp". &lt;/p&gt;
&lt;p&gt;Also, there are seven cases of "# of days with viable eggs" exceeding "# of 
days alive".&lt;/p&gt;
&lt;p&gt;I guess these data discrepancies further support my thinking of, "Don't take 
the results of my analysis too seriously.".&lt;/p&gt;
&lt;h1&gt;Descriptive Plots&lt;/h1&gt;
&lt;p&gt;Here's what the distribution of egg development stages looked like at the 
start and end of the experiment:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 1" src="https://swpease.github.io/images/science/sand_crabs/eggs/starting_stage_hist.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 2" src="https://swpease.github.io/images/science/sand_crabs/eggs/ending_stage_hist.png"&gt;&lt;/p&gt;
&lt;p&gt;And how many stages were progressed, based on starting stage, and split out 
by whether the crab died before the end of experiment or not.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 3" src="https://swpease.github.io/images/science/sand_crabs/eggs/stages_progressed.png"&gt;&lt;/p&gt;
&lt;p&gt;I was on the fence about splitting out the above figure by died/lived. I 
decided to, because with them combined, my first question was, "Did those 
starting stage 10 treatment crabs with no development progression die early?
". I suppose I could've coded died/lived by shape, too.&lt;/p&gt;
&lt;h1&gt;The Modeling&lt;/h1&gt;
&lt;p&gt;Firstly, an explanatory note re what follows. I did the modeling months 
ago, but had wanted to extend the model to incorporate censoring. Censored 
discrete distributions were(/are) not implemented in PyMC, as I discovered. 
One of the maintainers (Ricardo) fixed that problem within a couple of days 
of my bringing it up. However, said fix has been &lt;a href="https://github.com/pymc-devs/pymc/pull/7662"&gt;sitting in pull request 
purgatory&lt;/a&gt; for months now. Oh well. The point is, I'm revisiting this 
analysis months after having done it, so I am probably forgetting some 
nuances of decisions/explanations.&lt;/p&gt;
&lt;p&gt;So just looking at the above plots, I was expecting the model output to show 
minimal differences between treatments and controls, for whichever model I 
decided to use.&lt;/p&gt;
&lt;p&gt;I opted to use a proportional odds (ordered logit) model. I don't think it's 
entirely 
appropriate, and looking for an alternative model for ordinal data led me to 
discover the &lt;a href="https://www3.nd.
edu/~rwilliam/gologit2/UnderStandingGologit2016.pdf"&gt;generalized ordered logit model&lt;/a&gt;, but it seemed like the best 
option of any model options I could find. As it is, I don't really think 
that the appropriateness of a proportional odds model is 
assessable by humans without using the Brant Test. Or maybe I just haven't 
become one with the log-odds yet.&lt;/p&gt;
&lt;p&gt;The DAG of this model made me go "Woof!". On paper, its description is 
pretty simple: an ordered categorical outcome with an ordered categorical 
predictor and a categorical predictor. That is: final egg stage outcome with 
starting egg stage and treatment group predictors. Well, everything 
right/down of beta_trt is derived stuff (Stan's "generated quantities" block),
so 
I guess you can ignore that part.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 4" src="https://swpease.github.io/images/science/sand_crabs/eggs/DAG.png"&gt;&lt;/p&gt;
&lt;p&gt;And here is the PyMC model that produced that thing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;N_cutpoints&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage end of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;N_deltas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage at Beginning of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;t&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;end_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage end of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;start_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage at Beginning of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;cutpoint&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_cutpoints&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;model4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# Data&lt;/span&gt;
    &lt;span class="n"&gt;y_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;y_data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage end of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;obs_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;start_stage_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;start_stage_data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Egg Stage at Beginning of exp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;codes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;obs_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;grp_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;grp_data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;c_or_t_grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;obs_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Priors&lt;/span&gt;
    &lt;span class="n"&gt;cutpoints&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cutpoints&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                        &lt;span class="n"&gt;mu&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_cutpoints&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                        &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                    &lt;span class="c1"&gt;#   initval=(np.arange(N_cutpoints) / 2) - 2.5,&lt;/span&gt;
                        &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;distributions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;transforms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ordered&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;N_cutpoints&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;beta_trt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;beta_trt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mu&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;beta_start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Normal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;beta_start&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mu&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sigma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Dirichlet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;delta&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;repeat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_deltas&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;N_deltas&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;delta_j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;delta_j&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concatenate&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;delta_j_cumulative&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;delta_j_cumulative&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cumsum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delta_j&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="c1"&gt;# params&lt;/span&gt;
    &lt;span class="n"&gt;phi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;phi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                           &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;beta_start&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;delta_j_cumulative&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;start_stage_data&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; 
                            &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;beta_trt&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;grp_data&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                            &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;obs_id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# lik&lt;/span&gt;
    &lt;span class="n"&gt;y_obs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OrderedLogistic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;y_obs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                               &lt;span class="n"&gt;eta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;phi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                               &lt;span class="n"&gt;cutpoints&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cutpoints&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                               &lt;span class="n"&gt;observed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;y_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                               &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;grp_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

    &lt;span class="c1"&gt;# derived params&lt;/span&gt;
    &lt;span class="n"&gt;cutpoints_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cutpoints_col&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cutpoints&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
    &lt;span class="n"&gt;bc_delta_j_cumulative&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bc_delta_j_cumulative&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                        &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;broadcast_to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delta_j_cumulative&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_cutpoints&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_deltas&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
    &lt;span class="n"&gt;cutpoints_by_grp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cutpoints_by_grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                        &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
                                            &lt;span class="n"&gt;cutpoints_col&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bc_delta_j_cumulative&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;beta_start&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# phi = 0&lt;/span&gt;
                                            &lt;span class="n"&gt;cutpoints_col&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;bc_delta_j_cumulative&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;beta_start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;beta_trt&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;  &lt;span class="c1"&gt;# phi = beta_trt&lt;/span&gt;
                                        &lt;span class="p"&gt;],&lt;/span&gt;
                                        &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                                        &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cutpoint&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;start_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="c1"&gt;# derived vars&lt;/span&gt;
    &lt;span class="n"&gt;cum_probs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cum_probs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;invlogit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cutpoints_by_grp&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cutpoint&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;start_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;probs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Deterministic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;probs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                             &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concatenate&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cum_probs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
                             &lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concatenate&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;pm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;math&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="n"&gt;cum_probs&lt;/span&gt;&lt;span class="p"&gt;])),&lt;/span&gt;
                             &lt;span class="n"&gt;dims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;end_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;start_stage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;grp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I had quite a time making myself confident that the indexing tetris required 
for &lt;code&gt;probs&lt;/code&gt; wound up correct.&lt;/p&gt;
&lt;h2&gt;Output&lt;/h2&gt;
&lt;p&gt;Assessing the output of this model was a bit of a chore. I looked at it from 
a couple of different perspectives:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Posterior predictions&lt;/li&gt;
&lt;li&gt;The distributions of the &lt;code&gt;probs&lt;/code&gt; in a forest plot.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The first view looks neater, while the second provides HDI's.&lt;/p&gt;
&lt;p&gt;First, the posterior predictions. This graph could be cleaner, but the lack 
of any apparent difference between treatments and controls kind of took the 
wind out of my sails, at least to the extent of fixing the 
indexing and re-looking-up how to 
customize legends in seaborn/matplotlib. The bins are split by control = 0 
and treatment = 1 (as if it matters), and ordered by ending stage (0 = stage 
1, ..., 9 = stage 10, 10 = stage Z). I suppose the main wrong thing with 
this model is how the probability of final stages earlier than starting 
stages is non-zero.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 5" src="https://swpease.github.io/images/science/sand_crabs/eggs/posterior_preds.png"&gt;&lt;/p&gt;
&lt;p&gt;Second, the posterior probabilities arranged as ["end_stage", "start_stage", 
"grp"]. I think it's a bit interesting how the &lt;code&gt;end_stage&lt;/code&gt; of zygote 
monotonically increases with &lt;code&gt;start_stage&lt;/code&gt;, and non-zygote end stages kind 
of do a wave pattern indicating the most highly expected development of maybe 
5-ish stages (e.g. the [9, x, x] portion of the graph):&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 5" src="https://swpease.github.io/images/science/sand_crabs/eggs/posterior_probs.png"&gt;&lt;/p&gt;
&lt;p&gt;When it comes down to it, there's not a lot of data to go off of, though, 
and I don't think all this modeling work does a whole lot more than what 
could be eyeballed based on the descriptive stats/plots. &lt;/p&gt;
&lt;h1&gt;Conclusions&lt;/h1&gt;
&lt;p&gt;Keeping in mind the caveats of "not my experiment" and "I'm not an invert 
zoologist", I think that this experiment doesn't show any meaningful 
difference between treatments and controls in terms of egg development.&lt;/p&gt;
&lt;p&gt;Probably the most valuable thing to come out of this exercise was the 
(pending) enhancement to PyMC's capabilities. I figure that even if I'd 
gotten to incorporate censoring into the model, all it would've done 
would've been to make the HDI's wider and maybe push some point estimates 
around.&lt;/p&gt;
&lt;h1&gt;Discussion (but not what you're expecting)&lt;/h1&gt;
&lt;p&gt;I was thinking about the survival analysis from part 1, and it occurred to 
me that these "environmentally relevant concentrations" are if anything 
&lt;em&gt;low&lt;/em&gt;, because in the wild, there is a continuously replenishing supply of 
microplastics for the crabs to eat, while this experiment capped their 
exposure: if one of the three plastics was eaten, then the ambient 
concentration was now two per jar, until the new batch was introduced. So 
the crabs in the wild should be hurting even more than this experiment 
suggests. Have people noticed sand crab population shifts? I feel like as a 
kid there were tons around at the beach, but even just a decade later they 
were much rarer, though that's a pretty flimsy bit of anecdotal evidence 
(for instance, I 
certainly went to the shore much less often as I got older).&lt;/p&gt;</content><category term="Science"></category><category term="analysis"></category></entry><entry><title>Sand Crabs Eating Bits of Plastic String</title><link href="https://swpease.github.io/sand-crabs-eating-bits-of-plastic-string.html" rel="alternate"></link><published>2024-10-15T00:00:00-07:00</published><updated>2024-10-15T00:00:00-07:00</updated><author><name>Scott Pease</name></author><id>tag:swpease.github.io,2024-10-15:/sand-crabs-eating-bits-of-plastic-string.html</id><summary type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;I read a paper, &lt;a href="https://aslopubs.
onlinelibrary.wiley.com/doi/10.1002/lol2.10137"&gt;"Effects of environmentally relevant concentrations of 
microplastic fibers on Pacific mole crab (Emerita analoga) mortality and
reproduction." Horn DA; Granek EF; Steele CL. 2019.&lt;/a&gt; as part of reading up on 
stuff for a job I applied to. I had been learning how to use Bayesian …&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;I read a paper, &lt;a href="https://aslopubs.
onlinelibrary.wiley.com/doi/10.1002/lol2.10137"&gt;"Effects of environmentally relevant concentrations of 
microplastic fibers on Pacific mole crab (Emerita analoga) mortality and
reproduction." Horn DA; Granek EF; Steele CL. 2019.&lt;/a&gt; as part of reading up on 
stuff for a job I applied to. I had been learning how to use Bayesian 
methods, so this seemed like a good way to try our using real data from the 
wild. I'll link throughout to files in a repository that shows my work.&lt;/p&gt;
&lt;p&gt;The gist of the experiment was they set up 64 jars of sand + sea water, with a 
crab in 
each.
32 
were subject to the addition of three plastic fibers (1mm long) every four 
days, for up to 71 days. Dead crabs were frozen for later analysis.&lt;/p&gt;
&lt;p&gt;I have been a bit confused by their analysis methods. They use a linear 
mixed effects model, which is all well and good, but there seems to be a few 
things that don't make sense.&lt;/p&gt;
&lt;h1&gt;Data Discrepancies&lt;/h1&gt;
&lt;p&gt;The paper provides the data at two sites: &lt;a href="https://zenodo.
org/records/3564736"&gt;Zenodo&lt;/a&gt; and &lt;a href="https://github.
com/cwgrldotty/Sand-Crab-PSU-Data"&gt;GitHub&lt;/a&gt;. The problem is they don't line up: &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The GitHub data is missing rows.&lt;/li&gt;
&lt;li&gt;The Zenodo data is missing columns.&lt;/li&gt;
&lt;li&gt;Some of the data is different:&lt;ul&gt;
&lt;li&gt;environmental plastics present&lt;/li&gt;
&lt;li&gt;egg stage at end of experiment&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I think that the "egg stage at end of experiment" data is correct for GitHub,
and wrong for Zenodo, because there is a "# of egg stages" column as well 
that on the Zenodo dataset sometimes exceeds "egg stage at end of 
experiment", which would mean starting at negative egg stages.&lt;/p&gt;
&lt;p&gt;I don't think they used junk data for their analyses; I just think the 
uploads are wonky. Well, there is one possible data error: I think crab 15's 
days alive number should be 21, not 71, based on the 
recorded date of death. As someone with terrible handwriting, I could 
totally see mixing up a 2 and a 7. &lt;/p&gt;
&lt;p&gt;I made the presumed correction to crab 15 for my analyses. I used the Zenodo 
data for 
survival times because it wasn't missing crabs.&lt;/p&gt;
&lt;h1&gt;Survival Curve&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://github.
com/swpease/sand-crabs/blob/master/sand_crab_mortality.Rmd"&gt;R Markdown Notebook&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The lack of a survival curve surprised me. Instead, they have a boxplot that 
I can't figure out. It doesn't match the data. My guess is that it's the 
fitted survival times post-linear mixed effects model, i.e. it's the 
shrunken (via partial pooling) survival times. As it is, here is the 
survival curves, with 50% CI's:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 1" src="https://swpease.github.io/images/science/sand_crabs/survival_curves.png"&gt;&lt;/p&gt;
&lt;p&gt;I used a log-rank test to compare the treatment vs control groups' survival 
curves. The p-value of the (presumed) corrected data was 0.10, which is higher 
than the publication's value of 
0.03 for their assessment of difference in mortality. Though,
the (presumed) wrong data yielded a p-value for 
the log-rank test of 0.05, which is obviously much closer. &lt;/p&gt;
&lt;p&gt;10 vs 17 
deaths does seem quite a bit different. I always find myself mentally replacing 
something below some subconsciously-determined p-value threshold as 
"definitely", but 0.1 just means, well there's evidence. Unless I want it 
&lt;em&gt;not&lt;/em&gt; to be true, in which case I think, "yeah it's totally a case of that 
10%". I do 
think it's slightly interesting 
that 
the curves are the same for the first three weeks. I wonder if there's 
anything to that. Maybe it lends credence to the authors' idea that the 
mechanism of harm is the dyes in the plastics. I could imagine that 
the body burden of dye is 
steadily increasing over time.&lt;/p&gt;
&lt;h1&gt;"Number of PP Fibers Internalized"&lt;/h1&gt;
&lt;p&gt;I don't like this name for this variable. At the end of the experiment 
(crabs that died before the end were frozen), they 
dissolved the crabs and counted the number of plastic fibers they filtered 
out of that. That gives you the body burden at death/censoring, not 
necessarily the total number of fibers they internalized. What if they 
could expel the fibers somehow? Also, what if some of the fibers were stuck 
to their outside? I'm guessing they washed them or something to account for 
this, since they were meticulous in preventing contamination at all the 
other phases, but didn't mention anything. Or maybe it's a non-issue.&lt;/p&gt;
&lt;p&gt;This variable is used for regressions to explain mortality, the number of 
days that a crab held live/viable eggs, and other outcomes. I don't think 
it's an accurate representation of what it claims to be. Here is a graph of 
number of fibers collected out of each crab at the end of the experiment vs 
when they died:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 2" src="https://swpease.github.io/images/science/sand_crabs/body_burden.png"&gt;&lt;/p&gt;
&lt;p&gt;The horizontal axis has ticks every 20 because I couldn't figure out how to get 
ggplot to make it how I wanted in the amount of time it took for me to get 
mad at The Grammar of Graphics&amp;trade;.&lt;/p&gt;
&lt;p&gt;Anyway, it seems highly unlikely in looking at this graph that every fiber a 
crab intakes stays in it until death. The number never exceeds five, in 
spite of reaching five in one crab after one third of the experiment's 
duration, and three in one crab after nine days.&lt;/p&gt;
&lt;p&gt;I tried a statistical test to get at this being the case, by looking for an 
association between exposure duration (i.e. days alive in the experiment) and 
number of fibers internalized. I 
used a Poisson regression on &lt;span class="math"&gt;\(log(days)\)&lt;/span&gt;, because I read that doing so lets 
you combine data with different exposure durations, with the &lt;span class="math"&gt;\(log(days)\)&lt;/span&gt;'s 
coefficient indicating the change in rate over time. As it is, I feel like 
it would be difficult to find a statistical test that &lt;em&gt;did&lt;/em&gt; show some sort 
of relationship between counts and duration of exposure. So my model (in R 
code) was essentially (names changed for clarity): &lt;/p&gt;
&lt;p&gt;&lt;code&gt;glm(fibers ~ log(days 
alive), family = poisson(), data = 
treatment crabs)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Which yielded:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;param&lt;/th&gt;
&lt;th&gt;Estimate&lt;/th&gt;
&lt;th&gt;Std. Error&lt;/th&gt;
&lt;th&gt;z value&lt;/th&gt;
&lt;th&gt;Pr(&amp;gt;|z|)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;(Intercept)&lt;/td&gt;
&lt;td&gt;0.87576&lt;/td&gt;
&lt;td&gt;0.69172&lt;/td&gt;
&lt;td&gt;1.266&lt;/td&gt;
&lt;td&gt;0.205&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;log(num_of_days_alive)&lt;/td&gt;
&lt;td&gt;-0.07686&lt;/td&gt;
&lt;td&gt;0.18669&lt;/td&gt;
&lt;td&gt;-0.412&lt;/td&gt;
&lt;td&gt;0.681&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Which I interpret as "no, there isn't much of an association between counts and the different durations over which the counts accumulated", because of the small Estimate, relatively large Std. Error, and small Pr() for log(num_of_days_alive)."&lt;/p&gt;
&lt;p&gt;I kinda wish they'd checked the number of fibers suspended in the water of 
the jars somehow.&lt;/p&gt;
&lt;p&gt;I also wonder if sand crabs can vomit. This paper on decapod crustacean 
welfare in experiments [&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;] references a study on red rock crab digestive 
processes [&lt;sup id="fnref:2"&gt;&lt;a class="footnote-ref" href="#fn:2"&gt;2&lt;/a&gt;&lt;/sup&gt;] that observed regurgitation/vomiting. So maybe?&lt;/p&gt;
&lt;p&gt;Back to the statistics, the authors report a relationship between fibers 
internalized and a 
decrease 
in days alive. I'm skeptical that there's anything to it. If they 
incorporated some sort of accounting for censored observations (maybe &lt;code&gt;lme4&lt;/code&gt; 
handles things somehow?) they don't mention it in the publication.&lt;/p&gt;
&lt;h1&gt;Wait, what happened to Bayes?&lt;/h1&gt;
&lt;p&gt;Oh.&lt;/p&gt;
&lt;h2&gt;Exponentially Distributed Survival&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/swpease/sand-crabs/blob/master/sand_crabs.ipynb"&gt;Jupyter Notebook&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Well, I tried fitting an Exponential distribution to the mortality data, per 
the suggestion found in this lecture from &lt;a href="https://youtu.be/Zi6N3GLUJmw?si=AowaUikcftuAtCCk&amp;amp;t=4882"&gt;Statistical Rethinking&lt;/a&gt;. I 
think it looks okay?&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 3" src="https://swpease.github.io/images/science/sand_crabs/exponential_72d.png"&gt;&lt;/p&gt;
&lt;p&gt;and to see where these curves go:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 4" src="https://swpease.github.io/images/science/sand_crabs/exponential_730d.png"&gt;&lt;/p&gt;
&lt;p&gt;My biggest concern is: what would the data have wound up looking like if the 
experiment went on for longer?&lt;/p&gt;
&lt;p&gt;The graphs get a bit muddled where the treatment and control fits overlap, 
but there's nothing fascinating going on at the overlaps, so I just left it 
as is rather than double the number of graphs.&lt;/p&gt;
&lt;h3&gt;Picking a prior&lt;/h3&gt;
&lt;p&gt;The exponential model only has one parameter, &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;. The mean of an 
exponential distribution is &lt;span class="math"&gt;\(1 / 
\lambda\)&lt;/span&gt;, so what's the expected mean?&lt;/p&gt;
&lt;p&gt;As far as expected survival times, &lt;a href="https://en.
wikipedia.org/wiki/Emerita_analoga"&gt;according to Wikipedia&lt;/a&gt;, most sand crabs 
die in the autumn of their second year. These crabs were collected on August 4,
so I guess I'll assume ~400 days survival time for crabs in their first year,
maybe just ~50 for crabs in their second year,
and I guess half in their first v second year,
so ~200+ days average survival time. Can you age crabs? I don't suppose 
they've got otoliths.&lt;/p&gt;
&lt;p&gt;With that in mind, and per the suggestion of the &lt;a href="https://youtu.be/Zi6N3GLUJmw?si=apBRHdMb0lCodpNI&amp;amp;t=5366"&gt;al ighty cElreath&lt;/a&gt; to set the priors on the log 
of the inverse of &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;, so that they are easier to define, I went with 
a prior on said log inverse of &lt;span class="math"&gt;\(log(1/\lambda) \sim N(5, 1)\)&lt;/span&gt;, because &lt;span class="math"&gt;\(e^5 = 
148\)&lt;/span&gt; (and &lt;span class="math"&gt;\(e^4 = 55\)&lt;/span&gt; and &lt;span class="math"&gt;\(e^6 = 400\)&lt;/span&gt;). &lt;a href="https://github.com/swpease/sand-crabs/blob/master/simulated_exp_data.Rmd"&gt;R Markdown Notebook&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Expected Survival Times&lt;/h3&gt;
&lt;p&gt;So speaking of expected survival time, what does the Bayesian approach say 
it might be?&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 5" src="https://swpease.github.io/images/science/sand_crabs/forest_ridgeplot_90hdi.png"&gt;&lt;/p&gt;
&lt;p&gt;The posterior means of the mean survival time are 195 days for the control 
and 98 days for the treatment, but 
obviously 
it's pretty uncertain about the control, which makes sense given how few of 
the crabs died. You can see the uncertainty in the previous plot as well: those 
orange curves are pretty spread out. It's at least mildly encouraging that 
the control's posterior mean of the mean survival is fairly 
close to what I presumed 
based on the Wikipedia article. And the treatment mean survival time seems 
reasonable as well.&lt;/p&gt;
&lt;p&gt;And as for the contrast of &lt;span class="math"&gt;\(control - treatment\)&lt;/span&gt; expected survival times,
most of the 
probability 
mass is above zero, with a mean of 98 days (no, I didn't mistake it for the 
treatment's mean):&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 6" src="https://swpease.github.io/images/science/sand_crabs/forest_90hdi_contrast.png"&gt;&lt;/p&gt;
&lt;p&gt;So the treatment crabs probably don't live as long as the control crabs on 
average, but it's pretty uncertain what exactly the difference is.&lt;/p&gt;
&lt;h3&gt;Rejected Prior&lt;/h3&gt;
&lt;p&gt;I also toyed with the idea of describing the survival as a mix of two 
populations, first year and second year crabs, by using a mix of two 
Exponential distributions. I decided it was 
just more 
complicated without providing any apparent benefits. The curves it was 
producing looked pretty similar to an Exponential distribution. &lt;a href="https://github.com/swpease/sand-crabs/blob/master/simulated_exp_data_spectrum.Rmd"&gt;R Markdown 
Notebook&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Sensitivity to the Prior&lt;/h3&gt;
&lt;p&gt;There's not a ton of data, so how much does the prior matter? Not too much. 
It pushes the averages around, but the relationships are pretty consistent. &lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: center;"&gt;log(mu)-prior&lt;/th&gt;
&lt;th style="text-align: center;"&gt;mu-prior&lt;/th&gt;
&lt;th style="text-align: center;"&gt;sigma-prior&lt;/th&gt;
&lt;th style="text-align: center;"&gt;mu-post-ctrl&lt;/th&gt;
&lt;th style="text-align: center;"&gt;mu-post-trt&lt;/th&gt;
&lt;th style="text-align: center;"&gt;mu-post-contrast&lt;/th&gt;
&lt;th style="text-align: center;"&gt;P(contrast &amp;gt; 0)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;4&lt;/td&gt;
&lt;td style="text-align: center;"&gt;55&lt;/td&gt;
&lt;td style="text-align: center;"&gt;1&lt;/td&gt;
&lt;td style="text-align: center;"&gt;180&lt;/td&gt;
&lt;td style="text-align: center;"&gt;92&lt;/td&gt;
&lt;td style="text-align: center;"&gt;87&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;5&lt;/td&gt;
&lt;td style="text-align: center;"&gt;148&lt;/td&gt;
&lt;td style="text-align: center;"&gt;1&lt;/td&gt;
&lt;td style="text-align: center;"&gt;194&lt;/td&gt;
&lt;td style="text-align: center;"&gt;98&lt;/td&gt;
&lt;td style="text-align: center;"&gt;96&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.96&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;6&lt;/td&gt;
&lt;td style="text-align: center;"&gt;400&lt;/td&gt;
&lt;td style="text-align: center;"&gt;1&lt;/td&gt;
&lt;td style="text-align: center;"&gt;215&lt;/td&gt;
&lt;td style="text-align: center;"&gt;104&lt;/td&gt;
&lt;td style="text-align: center;"&gt;111&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.96&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;4&lt;/td&gt;
&lt;td style="text-align: center;"&gt;55&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.5&lt;/td&gt;
&lt;td style="text-align: center;"&gt;140&lt;/td&gt;
&lt;td style="text-align: center;"&gt;85&lt;/td&gt;
&lt;td style="text-align: center;"&gt;55&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.94&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;5&lt;/td&gt;
&lt;td style="text-align: center;"&gt;148&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.5&lt;/td&gt;
&lt;td style="text-align: center;"&gt;182&lt;/td&gt;
&lt;td style="text-align: center;"&gt;104&lt;/td&gt;
&lt;td style="text-align: center;"&gt;79&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.95&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: center;"&gt;6&lt;/td&gt;
&lt;td style="text-align: center;"&gt;400&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.5&lt;/td&gt;
&lt;td style="text-align: center;"&gt;251&lt;/td&gt;
&lt;td style="text-align: center;"&gt;131&lt;/td&gt;
&lt;td style="text-align: center;"&gt;119&lt;/td&gt;
&lt;td style="text-align: center;"&gt;0.95&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;Gamma Distributed Survival&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/swpease/sand-crabs/blob/master/sand_crabs_gamma.ipynb"&gt;Jupyter Notebook&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The gamma distribution gives a sigmoidal survival curve. Maybe that'll look 
a bit better? I think it does, particularly at the start, though it also 
seems to have more posterior 
draws that aren't particularly believable. For instance,
look at the control fits' cutoffs on the right at over 700 days.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Figure 7" src="https://swpease.github.io/images/science/sand_crabs/gamma_72d.png"&gt;
&lt;img alt="Figure 8" src="https://swpease.github.io/images/science/sand_crabs/gamma_730d.png"&gt;&lt;/p&gt;
&lt;h3&gt;Expected Survival Times&lt;/h3&gt;
&lt;p&gt;Overall, it's a similar story with the expected survival times here. The 
posterior 
means of the mean survival time are 195 days for the control 
and 84 days for the treatment, but 
once again 
it's pretty uncertain about the control. Actually, it's even more uncertain: 
the standard deviation in this case is 133, while it was merely 64 with the 
exponential model. This uncertainty propogates to the contrasts, though the 
probability density is still mostly above 0 (97% &amp;gt; 0), with a mean of 112.
&lt;img alt="Figure 9" src="https://swpease.github.io/images/science/sand_crabs/forest_ridgeplot_gamma_90hdi.png"&gt;
&lt;img alt="Figure 10" src="https://swpease.github.io/images/science/sand_crabs/contrast_gamma_90hdi.png"&gt;&lt;/p&gt;
&lt;h3&gt;Picking a Prior&lt;/h3&gt;
&lt;p&gt;This uses the same logic as above, but now needs two priors, &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt; 
(shape) and 
&lt;span class="math"&gt;\(\beta\)&lt;/span&gt; (rate), where for a gamma distribution &lt;span class="math"&gt;\(\mu = \alpha / \beta\)&lt;/span&gt; and 
&lt;span class="math"&gt;\(var = \alpha / \beta^2\)&lt;/span&gt;. I settled on &lt;span class="math"&gt;\(\alpha \sim Gamma(\alpha = 2, \beta = 
1)\)&lt;/span&gt; and &lt;span class="math"&gt;\(\beta \sim HalfNormal(\sigma = 0.02)\)&lt;/span&gt;, which gave mostly unabsurd 
survival curves in prior predictive simulation. &lt;/p&gt;
&lt;h3&gt;Rejected Prior&lt;/h3&gt;
&lt;p&gt;I also tried &lt;span class="math"&gt;\(\beta \sim LogNormal(\mu = -4, \sigma = 1)\)&lt;/span&gt;, but this did not 
seem to produce as good of fits to the data.&lt;/p&gt;
&lt;h3&gt;Sensitivity to the Prior&lt;/h3&gt;
&lt;p&gt;Changing the prior to &lt;span class="math"&gt;\(\beta \sim HalfNormal(\sigma = 0.2)\)&lt;/span&gt; yielded similar 
results. That's all I looked at because I'm sick of looking at survival curves.&lt;/p&gt;
&lt;h1&gt;Discussion / Conclusions&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Eating plastic is probably bad.&lt;/strong&gt; What a revelation. Really though, I am 
surprised at the posterior difference in expected survival time, because the 
experiment was designed to have environmentally relevant exposure levels. 
Do sand crabs have much shorter lifespans nowadays? Were the control crabs 
happy to have clean water (but not clean sediment!) for once? I wonder if it 
might be more accurate to think of the control as the effective "treatment", 
since the experimental treatment &lt;em&gt;ought&lt;/em&gt; to approximate the sand crabs' actual 
living conditions more closely.&lt;/p&gt;
&lt;p&gt;And can sand crabs 
vomit? The 
unanswered 
question. I suppose if they all had at least one fiber in them, they at the 
very least don't always vomit up accidentally ingested non-food. I wish 
they'd collected the poop.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stay tuned for part 2: egg stuff!&lt;/strong&gt;&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;"Anaesthesia of decapod crustaceans." de Souza Valente C. 2022.
https://doi.org/10.1016/j.vas.2022.100252&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id="fn:2"&gt;
&lt;p&gt;"Gastric processing and evacuation during emersion in the red rock 
crab, Cancer productus." Mcgaw IJ. 2007. https://doi.org/10.1080/10236240701393461&amp;#160;&lt;a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="Science"></category><category term="analysis"></category></entry></feed>